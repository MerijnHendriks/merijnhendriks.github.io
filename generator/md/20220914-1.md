# Hardening ubuntu 22.04 Desktop

...

## APT

Ubuntu's APT repositories do not use HTTP by default, making it vunerable to
MITM attacks [1][2][3]. To add an additional layer of defence against these
type of attacks, we can change the mirror urls to use HTTPS:

```sh
# change this command to use your mirror
sed --in-place --regexp-extended 's http://(nl\.archive\.ubuntu\.com|security\.ubuntu\.com) https://nl.archive.ubuntu.com g' /etc/apt/sources.list
```

General good advice is to not install 3rd party PPA's, just stick what Ubuntu
(and/or your company) provides.

## Firewall

Ubuntu's firewall is not enabled by default, nor does it contain any rules.
Assuming you don't need SSH, here is how you can enable the firewall with very
tight restrictions:

```sh
ufw default deny incoming
ufw default deny outgoing
ufw allow out to any port 53
ufw allow out to any port 443
ufw enable
```

This means that only outgoing DNS and HTTPS is allowed, but nothing else
outgoing nor incoming. In pactice this means that web browsers and software
using HTTPS to comminucate will remain functional, but anything else like SSH
won't by default. Normally APT wouldn't work either because of Ubuntu using
HTTP for its repositories, but it will thanks to the change we made earlier.

## Flatpak

Sandboxing

- [1] [justinsamuel.com](https://justinsamuel.com/papers/package-managers-ccs2008.pdf)
- [2] [justi.cz](https://justi.cz/security/2019/01/22/apt-rce.html)
- [3] [debian.org](https://www.debian.org/security/2016/dsa-3733)
