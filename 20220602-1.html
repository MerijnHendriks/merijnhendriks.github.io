<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="author" content="Merijn Hendriks"> <meta name="description" content="My personal blog."> <title>Merijn Hendriks</title> <link rel="icon" type="image/jpeg" href="./assets/img/favicon.jpg"> <link rel="stylesheet" type="text/css" href="./assets/css/bundle.css"> </head> <body> <header class="p-5 blog-banner"> <div class="container-fluid py-5"> <h1 class="fw-bold"><a href="./index.html">lp0 on fire</a></h1> <p class="fs-4">My personal blog</p> </div> </header> <div class="container-fluid d-flex flex-column"> <div class="row flex-grow-1"> <main class="col-lg-9 p-5"> <article> <h1>Website: Optimizing generation</h1> <p>After pondering at work, I decided to put more effort into optimizing the website generation. I had two goals in mind: replacing <code>jsdom</code> and improving <code>writeFile</code>'s performance.</p> <h2>JS-DOM</h2> <p>&quot;Dom&quot; in Dutch means &quot;dumb&quot;, so reading DOM always makes me chuckle a little.</p> <p>While <code>jsdom</code> is a very accurate emulation of the browser's DOM, I needed speed and not accuracy. <code>cheerio</code> wasn't complete enough for my use-case and I didn't know any other library at the time of writing the initial generator.</p> <p>Now that I spend some time researching, I found <code>linkedom</code>, an (almost) drop-in replacement for <code>jsdom</code> without the accuracy but with almost amazing speed and a very low footprint. It made me realize how much <code>jsdom</code> was actually bottlenecking my generator. With this change alone it became blazing fast, but there was still room left for improvement.</p> <h2>Async</h2> <p>On the low-end desktop I use at work I noticed the performance impact of having slow I/O operations. In this regard my program could improve easily by making it <code>async</code>. I don't manipulate the produced file, so I could write everything in parallel.</p> <p>...and so I did!</p> <p>While the results don't matter much on high-end hardware like my personal desktop computer, it does wonders for low-end hardware like my office pc or a low-end vps running the build command for each commit.</p> <h2>Result</h2> <p>A massive decrease in complexity and a massive increase in performance.</p> <p>Build time:</p> <ul> <li>old: 14s</li> <li>new: 5s</li> </ul> <p>Packages:</p> <ul> <li>old: 79</li> <li>new: 38</li> </ul> </article> </main> <aside class="col-lg-3 blog-sidebar"> <div class="p-5"> <h4>About</h4> <p>Hi! My name is Merijn Hendriks and I'm a Dutch programmer with a love for hamburgers and sake nigiri. When I'm not programming all day, you can find me reading manga, playing S.T.A.L.K.E.R.: Call of Pripyat or D&amp;D5E / MTG with friends.</p> <h4>Links</h4> <ul> <li><a href="https://www.github.com/merijnhendriks">Github</a></li><li><a href="mailto:me@nohurry.moe">Email</a></li><li><a href="https://nohurry.moe/feed.rss">RSS</a></li> </ul> </div> </aside> </div> </div> </body> </html>